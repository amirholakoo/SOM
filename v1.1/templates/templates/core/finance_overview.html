{% extends 'base.html' %}
{% load static %}

{% block title %}ğŸ’° Ù†Ù…Ø§ÛŒ Ú©Ù„ÛŒ Ù…Ø§Ù„ÛŒ - HomayOMS{% endblock %}

{% block extra_css %}
<style>
    .finance-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 2rem 0;
        margin-bottom: 2rem;
        border-radius: 15px;
    }
    
    .stat-card {
        background: white;
        border-radius: 15px;
        padding: 1.5rem;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        transition: transform 0.3s ease;
        border-left: 5px solid;
        margin-bottom: 1.5rem;
    }
    
    .stat-card:hover {
        transform: translateY(-5px);
    }
    
    .stat-card.revenue { border-left-color: #28a745; }
    .stat-card.expenses { border-left-color: #dc3545; }
    .stat-card.profit { border-left-color: #007bff; }
    .stat-card.orders { border-left-color: #ffc107; }
    
    .stat-number {
        font-size: 2.5rem;
        font-weight: bold;
        margin-bottom: 0.5rem;
    }
    
    .stat-label {
        color: #6c757d;
        font-size: 1rem;
        margin-bottom: 0.5rem;
    }
    
    .stat-change {
        font-size: 0.875rem;
        font-weight: bold;
    }
    
    .stat-change.positive { color: #28a745; }
    .stat-change.negative { color: #dc3545; }
    
    .report-section {
        background: white;
        border-radius: 15px;
        padding: 1.5rem;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        margin-bottom: 1.5rem;
    }
    
    .btn-finance {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        color: white;
        padding: 0.75rem 1.5rem;
        border-radius: 8px;
        font-weight: bold;
        transition: all 0.3s ease;
    }
    
    .btn-finance:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        color: white;
    }
    
    .filter-panel {
        background: #f8f9fa;
        border-radius: 10px;
        padding: 1rem;
        margin-bottom: 1.5rem;
    }
    
    .table th {
        background-color: #667eea;
        color: white;
        border: none;
    }
    
    .badge-status {
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: bold;
    }
    
    .badge-paid { background-color: #d4edda; color: #155724; }
    .badge-pending { background-color: #fff3cd; color: #856404; }
    .badge-overdue { background-color: #f8d7da; color: #721c24; }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Navigation -->
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'accounts:dashboard' %}">ğŸ  Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯</a></li>
            <li class="breadcrumb-item"><a href="{% url 'core:finance_dashboard' %}">ğŸ’° Ù…Ø§Ù„ÛŒ</a></li>
            <li class="breadcrumb-item active">Ù†Ù…Ø§ÛŒ Ú©Ù„ÛŒ</li>
        </ol>
    </nav>

    <!-- Header Section -->
    <div class="finance-header text-center">
        <div class="container">
            <h1>ğŸ’° Ù†Ù…Ø§ÛŒ Ú©Ù„ÛŒ Ù…Ø§Ù„ÛŒ</h1>
            <p class="lead mb-0">Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§ÛŒ ØªÙØµÛŒÙ„ÛŒ Ù…Ø§Ù„ÛŒ Ùˆ ØªØ­Ù„ÛŒÙ„ Ø¹Ù…Ù„Ú©Ø±Ø¯</p>
        </div>
    </div>
    
    <!-- Filter Panel -->
    <div class="filter-panel">
        <div class="row">
            <div class="col-md-3">
                <label class="form-label">ğŸ“… Ø¨Ø§Ø²Ù‡ Ø²Ù…Ø§Ù†ÛŒ:</label>
                <select class="form-select" id="timeRange">
                    <option value="today">Ø§Ù…Ø±ÙˆØ²</option>
                    <option value="week">Ø§ÛŒÙ† Ù‡ÙØªÙ‡</option>
                    <option value="month" selected>Ø§ÛŒÙ† Ù…Ø§Ù‡</option>
                    <option value="quarter">Ø§ÛŒÙ† ÙØµÙ„</option>
                    <option value="year">Ø§ÛŒÙ† Ø³Ø§Ù„</option>
                </select>
            </div>
            <div class="col-md-3">
                <label class="form-label">ğŸ’° ÙˆØ§Ø­Ø¯ Ù¾ÙˆÙ„:</label>
                <select class="form-select" id="currency">
                    <option value="rial">Ø±ÛŒØ§Ù„</option>
                    <option value="toman" selected>ØªÙˆÙ…Ø§Ù†</option>
                </select>
            </div>
            <div class="col-md-4">
                <label class="form-label">ğŸ” ÙÛŒÙ„ØªØ±:</label>
                <input type="text" class="form-control" placeholder="Ø¬Ø³ØªØ¬Ùˆ Ø¯Ø± Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§..." id="searchFilter">
            </div>
            <div class="col-md-2 d-flex align-items-end">
                <button class="btn btn-finance w-100" onclick="updateReports()">
                    ğŸ”„ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ
                </button>
            </div>
        </div>
    </div>
    
    <!-- Statistics Cards -->
    <div class="row">
        <div class="col-md-3">
            <div class="stat-card revenue">
                <div class="stat-number text-success" id="totalRevenue">45,250,000 Øª</div>
                <div class="stat-label">ğŸ’° Ú©Ù„ Ø¯Ø±Ø¢Ù…Ø¯</div>
                <div class="stat-change positive">
                    â†—ï¸ +12.5% Ù†Ø³Ø¨Øª Ø¨Ù‡ Ù…Ø§Ù‡ Ù‚Ø¨Ù„
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stat-card expenses">
                <div class="stat-number text-danger" id="totalExpenses">12,800,000 Øª</div>
                <div class="stat-label">ğŸ’¸ Ú©Ù„ Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§</div>
                <div class="stat-change negative">
                    â†˜ï¸ -5.2% Ù†Ø³Ø¨Øª Ø¨Ù‡ Ù…Ø§Ù‡ Ù‚Ø¨Ù„
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stat-card profit">
                <div class="stat-number text-primary" id="netProfit">32,450,000 Øª</div>
                <div class="stat-label">ğŸ“ˆ Ø³ÙˆØ¯ Ø®Ø§Ù„Øµ</div>
                <div class="stat-change positive">
                    â†—ï¸ +18.7% Ù†Ø³Ø¨Øª Ø¨Ù‡ Ù…Ø§Ù‡ Ù‚Ø¨Ù„
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stat-card orders">
                <div class="stat-number text-warning" id="totalOrders">127</div>
                <div class="stat-label">ğŸ›’ ØªØ¹Ø¯Ø§Ø¯ Ø³ÙØ§Ø±Ø´Ø§Øª</div>
                <div class="stat-change positive">
                    â†—ï¸ +8.3% Ù†Ø³Ø¨Øª Ø¨Ù‡ Ù…Ø§Ù‡ Ù‚Ø¨Ù„
                </div>
            </div>
        </div>
    </div>
    
    <!-- Financial Reports -->
    <div class="row">
        <div class="col-md-8">
            <div class="report-section">
                <h5 class="mb-3">ğŸ§¾ Ø¢Ø®Ø±ÛŒÙ† ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§</h5>
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>ğŸ“… ØªØ§Ø±ÛŒØ®</th>
                                <th>ğŸ“‹ Ù†ÙˆØ¹</th>
                                <th>ğŸ’° Ù…Ø¨Ù„Øº</th>
                                <th>ğŸ“Š ÙˆØ¶Ø¹ÛŒØª</th>
                                <th>ğŸ‘¤ Ù…Ø´ØªØ±ÛŒ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1403/04/15</td>
                                <td>ÙØ±ÙˆØ´ Ù…Ø­ØµÙˆÙ„</td>
                                <td class="text-success">+2,500,000 Øª</td>
                                <td><span class="badge-status badge-paid">âœ… Ù¾Ø±Ø¯Ø§Ø®Øª Ø´Ø¯Ù‡</span></td>
                                <td>Ø´Ø±Ú©Øª ABC</td>
                            </tr>
                            <tr>
                                <td>1403/04/14</td>
                                <td>Ø®Ø±ÛŒØ¯ Ù…ÙˆØ§Ø¯ Ø§ÙˆÙ„ÛŒÙ‡</td>
                                <td class="text-danger">-850,000 Øª</td>
                                <td><span class="badge-status badge-pending">â³ Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±</span></td>
                                <td>ØªØ§Ù…ÛŒÙ†â€ŒÚ©Ù†Ù†Ø¯Ù‡ XYZ</td>
                            </tr>
                            <tr>
                                <td>1403/04/13</td>
                                <td>ÙØ±ÙˆØ´ Ù…Ø­ØµÙˆÙ„</td>
                                <td class="text-success">+1,200,000 Øª</td>
                                <td><span class="badge-status badge-paid">âœ… Ù¾Ø±Ø¯Ø§Ø®Øª Ø´Ø¯Ù‡</span></td>
                                <td>Ù…Ø´ØªØ±ÛŒ DEF</td>
                            </tr>
                            <tr>
                                <td>1403/04/12</td>
                                <td>Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª</td>
                                <td class="text-warning">-300,000 Øª</td>
                                <td><span class="badge-status badge-overdue">âŒ Ù…Ø¹ÙˆÙ‚Ù‡</span></td>
                                <td>Ù…Ø´ØªØ±ÛŒ GHI</td>
                            </tr>
                            <tr>
                                <td>1403/04/11</td>
                                <td>ÙØ±ÙˆØ´ Ù…Ø­ØµÙˆÙ„</td>
                                <td class="text-success">+3,100,000 Øª</td>
                                <td><span class="badge-status badge-paid">âœ… Ù¾Ø±Ø¯Ø§Ø®Øª Ø´Ø¯Ù‡</span></td>
                                <td>Ø´Ø±Ú©Øª JKL</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="text-center mt-3">
                    <button class="btn btn-outline-primary">ğŸ“„ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù‡Ù…Ù‡ ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§</button>
                </div>
            </div>
        </div>
        
        <div class="col-md-4">
            <div class="report-section">
                <h5 class="mb-3">ğŸ“ˆ Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§ÛŒ Ø³Ø±ÛŒØ¹</h5>
                <div class="d-grid gap-3">
                    <button class="btn btn-outline-success py-3">
                        <div class="fs-2 mb-2">ğŸ’°</div>
                        <div>Ú¯Ø²Ø§Ø±Ø´ ÙØ±ÙˆØ´</div>
                        <small class="text-muted">Ø¢Ù…Ø§Ø± ÙØ±ÙˆØ´ Ù…Ø§Ù‡Ø§Ù†Ù‡</small>
                    </button>
                    <button class="btn btn-outline-danger py-3">
                        <div class="fs-2 mb-2">ğŸ›’</div>
                        <div>Ú¯Ø²Ø§Ø±Ø´ Ø®Ø±ÛŒØ¯</div>
                        <small class="text-muted">Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø®Ø±ÛŒØ¯</small>
                    </button>
                    <button class="btn btn-outline-primary py-3">
                        <div class="fs-2 mb-2">ğŸ“Š</div>
                        <div>Ú¯Ø²Ø§Ø±Ø´ Ø³ÙˆØ¯Ø¢ÙˆØ±ÛŒ</div>
                        <small class="text-muted">ØªØ­Ù„ÛŒÙ„ Ø³ÙˆØ¯ Ùˆ Ø²ÛŒØ§Ù†</small>
                    </button>
                    <button class="btn btn-outline-warning py-3">
                        <div class="fs-2 mb-2">ğŸ“¦</div>
                        <div>Ú¯Ø²Ø§Ø±Ø´ Ù…ÙˆØ¬ÙˆØ¯ÛŒ</div>
                        <small class="text-muted">Ø§Ø±Ø²Ø´ Ø§Ù†Ø¨Ø§Ø±</small>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Summary Section -->
    <div class="report-section">
        <h5 class="mb-3">ğŸ“‹ Ø®Ù„Ø§ØµÙ‡ Ø¹Ù…Ù„Ú©Ø±Ø¯ Ù…Ø§Ù„ÛŒ</h5>
        <div class="row">
            <div class="col-md-6">
                <h6>ğŸ“ˆ Ù†Ú©Ø§Øª Ù…Ø«Ø¨Øª:</h6>
                <ul class="list-unstyled">
                    <li class="text-success">âœ… Ø§ÙØ²Ø§ÛŒØ´ 12.5% Ø¯Ø±Ø¢Ù…Ø¯ Ù†Ø³Ø¨Øª Ø¨Ù‡ Ù…Ø§Ù‡ Ù‚Ø¨Ù„</li>
                    <li class="text-success">âœ… Ú©Ø§Ù‡Ø´ 5.2% Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§</li>
                    <li class="text-success">âœ… Ø±Ø´Ø¯ 18.7% Ø³ÙˆØ¯ Ø®Ø§Ù„Øµ</li>
                    <li class="text-success">âœ… Ø§ÙØ²Ø§ÛŒØ´ 8.3% ØªØ¹Ø¯Ø§Ø¯ Ø³ÙØ§Ø±Ø´Ø§Øª</li>
                </ul>
            </div>
            <div class="col-md-6">
                <h6>âš ï¸ Ù†Ú©Ø§Øª Ù‚Ø§Ø¨Ù„ ØªÙˆØ¬Ù‡:</h6>
                <ul class="list-unstyled">
                    <li class="text-warning">âš ï¸ 3 ÙØ§Ú©ØªÙˆØ± Ù…Ø¹ÙˆÙ‚Ù‡</li>
                    <li class="text-warning">âš ï¸ Ø§ÙØ²Ø§ÛŒØ´ Ù‡Ø²ÛŒÙ†Ù‡ Ø­Ù…Ù„ Ùˆ Ù†Ù‚Ù„</li>
                    <li class="text-info">â„¹ï¸ ÙØ±ØµØª Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¯Ø± Ø¨Ø®Ø´ Ø®Ø±ÛŒØ¯</li>
                    <li class="text-info">â„¹ï¸ Ù¾ØªØ§Ù†Ø³ÛŒÙ„ Ø±Ø´Ø¯ Ø¯Ø± Ø¨Ø§Ø²Ø§Ø± Ø¬Ø¯ÛŒØ¯</li>
                </ul>
            </div>
        </div>
    </div>
    
    <!-- Export Options -->
    <div class="report-section">
        <h5 class="mb-3">ğŸ“¤ Ø®Ø±ÙˆØ¬ÛŒ Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§</h5>
        <div class="row">
            <div class="col-md-8">
                <p class="text-muted">Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§ÛŒ Ù…Ø§Ù„ÛŒ Ø±Ø§ Ø¨Ù‡ ÙØ±Ù…Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù Ø¯Ø§Ù†Ù„ÙˆØ¯ Ú©Ù†ÛŒØ¯</p>
            </div>
            <div class="col-md-4 text-end">
                <button class="btn btn-outline-success me-2">
                    ğŸ“Š Excel
                </button>
                <button class="btn btn-outline-danger me-2">
                    ğŸ“„ PDF
                </button>
                <button class="btn btn-outline-primary">
                    ğŸ–¨ï¸ Ú†Ø§Ù¾
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Update Reports Function
    function updateReports() {
        const timeRange = document.getElementById('timeRange').value;
        
        // Show loading state
        const elements = ['totalRevenue', 'totalExpenses', 'netProfit', 'totalOrders'];
        elements.forEach(id => {
            document.getElementById(id).textContent = 'â³ Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...';
        });
        
        // Simulate API call
        setTimeout(() => {
            // Update with sample data based on time range
            let multiplier = 1;
            switch(timeRange) {
                case 'today':
                    multiplier = 0.1;
                    break;
                case 'week':
                    multiplier = 0.3;
                    break;
                case 'month':
                    multiplier = 1;
                    break;
                case 'quarter':
                    multiplier = 3;
                    break;
                case 'year':
                    multiplier = 12;
                    break;
            }
            
            document.getElementById('totalRevenue').textContent = 
                Math.round(45250000 * multiplier).toLocaleString() + ' Øª';
            document.getElementById('totalExpenses').textContent = 
                Math.round(12800000 * multiplier).toLocaleString() + ' Øª';
            document.getElementById('netProfit').textContent = 
                Math.round(32450000 * multiplier).toLocaleString() + ' Øª';
            document.getElementById('totalOrders').textContent = 
                Math.round(127 * multiplier);
        }, 1000);
    }
    
    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
        updateReports();
    });
    
    // Add search functionality
    document.getElementById('searchFilter').addEventListener('input', function(e) {
        const searchTerm = e.target.value.toLowerCase();
        const rows = document.querySelectorAll('tbody tr');
        
        rows.forEach(row => {
            const text = row.textContent.toLowerCase();
            row.style.display = text.includes(searchTerm) ? '' : 'none';
        });
    });
</script>
{% endblock %} 